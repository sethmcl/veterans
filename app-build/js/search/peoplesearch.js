define(function(a){function g(){var a=k();b.pub("search","search-begin"),window.IN&&IN.API&&IN.API.Raw&&IN.API.Raw().url(a).method("GET").result(i).error(j)}function h(){var a=d.get("start"),b=d.get("count"),e=d.get("total"),f=d.get("hasMore");if(!f)return;c.set({start:a+b})}function i(a){var c=[],e=[],f=a.people._start,g=a.people._count,h=a.people._total,i=!1;f+g<=h&&(i=!0),d.set({start:f,count:g,total:h,peopleCount:h,hasMore:i}),_.each(a.facets.values,function(a){c.push(a)}),d.setFacets(c),_.each(a.people.values,function(a){e.push(a)}),f===0||!f?d.setPeople(e):d.appendPeople(e),b.pub("search","search-returned")}function j(){b.pub("search","search-returned")}function k(){function b(a,b,d){var e=c.get(b);return typeof e=="object"&&e!==null&&e.length&&e.length>0&&(a+="facet="+d+","+e.join(",")+"&"),a}function d(a,b,d){var d=d||b,e=c.get(b);return typeof e!="undefined"&&e!==null&&(a+=d+"="+e+"&"),a}function e(a,b,d){var d=d||b,e=c.get(b);return typeof e!="undefined"&&e!==null&&(a+=d+"="+Boolean(e).toString()+"&"),a}function g(a,b,d){var d=d||b,e=c.get(b);return typeof e=="object"&&e!==null&&e.length&&e.length>0&&(a+=d+"="+e.join(",")+"&"),a}var a=f;return a=d(a,"keywords"),a=d(a,"first-name"),a=d(a,"last-name"),a=d(a,"company-name"),a=e(a,"current-company"),a=d(a,"title"),a=e(a,"current-title"),a=d(a,"school-name"),a=e(a,"current-school"),a=d(a,"country-code"),a=d(a,"postal-code"),a=d(a,"distance"),a=d(a,"start"),a=d(a,"count"),a=d(a,"sort"),a=d(a,"visibility"),a=g(a,"facets"),a=b(a,"cohorts-location","location"),a=b(a,"cohorts-industry","industry"),a=b(a,"cohorts-network","network"),a=b(a,"cohorts-language","language"),a=b(a,"cohorts-current-company","current-company"),a=b(a,"cohorts-past-company","past-company"),a=b(a,"cohorts-school","school"),a}var b=a("util/channel"),c=a("models/peopleSearchInput"),d=a("models/peopleSearchResults"),e={},f=["/people-search:(","people:(id,first-name,last-name,picture-url,","headline,industry,location,public-profile-url,distance)",",facets:(name,code,buckets:(name,code,count,selected))",")?"].join("");return c.bind("change",g),b.sub("search","get-more-people",h),e})